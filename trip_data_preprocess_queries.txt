tripWorker.df.show()
+--------------------+--------------------+---------+---------+------------------+-------------------+-------------------+---------------+-----------------+-------------+----------------+---------------+-----------------+----------------+
|           medallion|        hack_license|vendor_id|rate_code|store_and_fwd_flag|    pickup_datetime|   dropoff_datetime|passenger_count|trip_time_in_secs|trip_distance|pickup_longitude|pickup_latitude|dropoff_longitude|dropoff_latitude|
+--------------------+--------------------+---------+---------+------------------+-------------------+-------------------+---------------+-----------------+-------------+----------------+---------------+-----------------+----------------+
|89D227B655E5C82AE...|BA96DE419E711691B...|      CMT|        1|                 N|2013-01-01 15:11:48|2013-01-01 15:18:10|              4|              382|          1.0|      -73.978165|      40.757977|        -73.98984|        40.75117|
|0BD7C8F5BA12B88E0...|9FD8F69F0804BDB55...|      CMT|        1|                 N|2013-01-06 00:18:35|2013-01-06 00:22:54|              1|              259|          1.5|       -74.00668|       40.73178|         -73.9945|        40.75066|
|0BD7C8F5BA12B88E0...|9FD8F69F0804BDB55...|      CMT|        1|                 N|2013-01-05 18:49:41|2013-01-05 18:54:23|              1|              282|          1.1|       -74.00471|       40.73777|       -74.009834|          40.726|
|DFD2202EE08F7A8DC...|51EE87E3205C985EF...|      CMT|        1|                 N|2013-01-07 23:54:15|2013-01-07 23:58:20|              2|              244|          0.7|        -73.9746|      40.759945|        -73.98473|       40.759388|
|DFD2202EE08F7A8DC...|51EE87E3205C985EF...|      CMT|        1|                 N|2013-01-07 23:25:03|2013-01-07 23:34:24|              1|              560|          2.1|       -73.97625|      40.748528|        -74.00259|       40.747868|
|20D9ECB2CA0767CF7...|598CCE5B9C1918568...|      CMT|        1|                 N|2013-01-07 15:27:48|2013-01-07 15:38:37|              1|              648|          1.7|       -73.96674|       40.76425|        -73.98332|       40.743763|
|496644932DF393260...|513189AD756FF14FE...|      CMT|        1|                 N|2013-01-08 11:01:15|2013-01-08 11:08:14|              1|              418|          0.8|      -73.995804|      40.743977|       -74.007416|       40.744343|
|8B7DB5F212307EF40...|DE6C6303882CDA159...|      VTS|        2|              null|2013-01-13 10:55:00|2013-01-13 11:24:00|              1|             1740|        17.09|             0.0|            0.0|              0.0|             0.0|
+--------------------+--------------------+---------+---------+------------------+-------------------+-------------------+---------------+-----------------+-------------+----------------+---------------+-----------------+----------------+

================================================================================================================================================================================================================================================

num_cols = [f.name for f in tripWorker.df.schema.fields if isinstance(f.dataType, t.NumericType)]
tripWorker.df.select(num_cols).summary().show()
+-------+------------------+------------------+------------------+-----------------+------------------+-----------------+-----------------+-----------------+
|summary|         rate_code|   passenger_count| trip_time_in_secs|    trip_distance|  pickup_longitude|  pickup_latitude|dropoff_longitude| dropoff_latitude|
+-------+------------------+------------------+------------------+-----------------+------------------+-----------------+-----------------+-----------------+
|  count|         173179759|         173179759|         173179759|        173179759|         173179759|        173179759|        173176321|        173176321|
|   mean|1.0337213022683558|1.7094193669596225| 811.9999416964196|8.305137246352254|-72.45156327315387|39.75292675450606|-72.4081049072237|39.72998349248398|
| stddev|0.3391333355137789|1.3767439366809258|15815.405665025886|6639.903068837684|11.291790226013369| 8.78031744246909|11.41710365961806|8.867562586757927|
|    min|                 0|                 0|             -6480|              0.0|         -3084.296|       -3547.9207|       -3116.2698|       -3547.9207|
|    25%|                 1|                 1|               360|             1.04|         -73.99218|         40.73448|        -73.99146|        40.733543|
|    50%|                 1|                 1|               600|              1.8|         -73.98185|        40.752365|        -73.98023|          40.7528|
|    75%|                 1|                 2|               960|              3.2|        -73.966835|        40.767017|        -73.96359|        40.767803|
|    max|               239|               255|           4294966|        1.53318E7|         2945.9587|        3310.3645|         2386.995|         3577.132|
+-------+------------------+------------------+------------------+-----------------+------------------+-----------------+-----------------+-----------------+

================================================================================================================================================================================================================================================

tripWorker.df.select(rate_code).distinct().show()
+---------+
|rate_code|
+---------+
|        1|
|        6|
|        3|
|        5|
|        4|
|        8|
|        2|
|        0|
|      210|
|       28|
|        7|
|        9|
|       65|
|      128|
|       10|
|       13|
|       15|
|       79|
|      221|
|       17|
|      208|
|      206|
|       77|
|      239|
|      200|
|       16|
+---------+

================================================================================================================================================================================================================================================

tripWorker.df.select(passenger_count).distinct().show()
+---------------+
|passenger_count|
+---------------+
|              1|
|              6|
|              3|
|              5|
|              4|
|              2|
|              0|
|            208|
|              9|
|            255|
|              7|
|              8|
|            129|
+---------------+

================================================================================================================================================================================================================================================

(tripWorker.df
 .select(trip_distance, (col(trip_distance) / 1000.0).alias(trip_distance+' in km'))
 .filter(col(trip_distance+' in km') > 1)
 .distinct().orderBy(trip_distance+' in km').show(10000))
+-------------+-------------------+
|trip_distance|trip_distance in km|
+-------------+-------------------+
|       1000.5|             1.0005|
|       1005.0|              1.005|
|       1040.0|               1.04|
|       1047.4| 1.0474000244140624|
|       1232.0|              1.232|
|       1300.0|                1.3|
|       1300.5|             1.3005|
|       1313.1| 1.3130999755859376|
|       1320.6| 1.3205999755859374|
|       1350.0|               1.35|
|       1440.0|               1.44|
|       1483.1| 1.4830999755859375|
|       1485.2|  1.485199951171875|
|       1500.0|                1.5|
|       1566.6| 1.5665999755859374|
|       1574.6| 1.5745999755859375|
|       1600.0|                1.6|
|       1650.0|               1.65|
|       1800.0|                1.8|
|       2001.9| 2.0019000244140623|
|       2139.5|             2.1395|
|       2500.5|             2.5005|
|       2800.5|             2.8005|
|       2840.0|               2.84|
|       3008.3|  3.008300048828125|
|       3107.3|  3.107300048828125|
|       3180.0|               3.18|
|       3199.8|  3.199800048828125|
|       3300.0|                3.3|
|       4000.0|                4.0|
|       4202.0|              4.202|
|       4206.0|              4.206|
|       4900.5|             4.9005|
|       5000.0|                5.0|
|       5005.0|              5.005|
|       5053.0|              5.053|
|       5053.2|    5.0532001953125|
|       5063.2|    5.0632001953125|
|       5900.5|             5.9005|
|       6005.0|              6.005|
|       6405.0|              6.405|
|       6674.6|   6.67460009765625|
|       6746.3|    6.7462998046875|
|       6747.8|    6.7477998046875|
|       7454.0|              7.454|
|       7468.0|              7.468|
|       7472.2|    7.4722001953125|
|       8000.0|                8.0|
|       8000.6|   8.00060009765625|
|       8005.0|              8.005|
|       8045.4|   8.04539990234375|
|       8083.0|              8.083|
|       8095.0|              8.095|
|       8100.9|   8.10089990234375|
|       8214.0|              8.214|
|       8600.0|                8.6|
|       9000.0|                9.0|
|      10050.3|   10.0502998046875|
|      11005.0|             11.005|
|      12004.5|            12.0045|
|      12200.5|            12.2005|
|      12730.0|              12.73|
|      13005.0|             13.005|
|      14500.5|            14.5005|
|      14685.6|    14.685599609375|
|      14823.0|             14.823|
|      15682.2|   15.6822001953125|
|      22005.0|             22.005|
|      23005.0|             23.005|
|      25000.0|               25.0|
|      25400.0|               25.4|
|      28400.0|               28.4|
|      29005.0|             29.005|
|      30083.0|             30.083|
|      31800.0|               31.8|
|      33180.0|              33.18|
|      36674.3|     36.67430078125|
|      38005.0|             38.005|
|      40005.0|             40.005|
|      40050.6|      40.0506015625|
|      43003.2|     43.00319921875|
|      45000.0|               45.0|
|      50033.1|      50.0331015625|
|      50133.0|             50.133|
|      50432.8|     50.43280078125|
|      50433.1|      50.4331015625|
|      50533.0|             50.533|
|      50633.1|      50.6331015625|
|      50733.1|      50.7331015625|
|      50833.0|             50.833|
|      50933.1|      50.9331015625|
|      51033.0|             51.033|
|      51232.8|     51.23280078125|
|      51428.0|             51.428|
|      51533.0|             51.533|
|      60000.0|               60.0|
|      60050.0|              60.05|
|      63318.0|             63.318|
|      70050.2|       70.050203125|
|      72005.0|             72.005|
|      73023.2|       73.023203125|
|      77005.0|             77.005|
|      80001.0|             80.001|
|      80051.3|       80.051296875|
|      83180.0|              83.18|
|      86029.0|             86.029|
|      90051.3|       90.051296875|
|      95802.0|             95.802|
|      98005.0|             98.005|
|     100051.1|     100.0511015625|
|     100502.3|      100.502296875|
|     110050.4|     110.0503984375|
|     110284.0|            110.284|
|     120000.6|     120.0006015625|
|     130050.6|     130.0506015625|
|     135005.0|            135.005|
|     146801.5|           146.8015|
|     147005.0|            147.005|
|     148011.0|            148.011|
|     150004.5|           150.0045|
|     170051.2|      170.051203125|
|     180051.0|            180.051|
|     180051.3|      180.051296875|
|     200505.3|      200.505296875|
|     250000.0|              250.0|
|     288703.9|       288.70390625|
|     290051.4|       290.05140625|
|     318000.0|              318.0|
|     318116.6|       318.11659375|
|     330050.4|       330.05040625|
|     350000.0|              350.0|
|     350050.2|        350.0501875|
|     419500.0|              419.5|
|     500000.0|              500.0|
|     500332.0|            500.332|
|     500501.0|            500.501|
|     501331.8|        501.3318125|
|     501332.0|            501.332|
|     507331.8|        507.3318125|
|     512331.8|        512.3318125|
|     514331.8|        514.3318125|
|     514332.0|            514.332|
|     515328.4|       515.32840625|
|     515331.8|        515.3318125|
|     515566.6|       515.56659375|
|     522133.0|            522.133|
|     533180.0|             533.18|
|     582331.8|        582.3318125|
|     600003.2|        600.0031875|
|     600100.5|           600.1005|
|     600501.0|            600.501|
|     666746.0|            666.746|
|     667470.0|             667.47|
|     670051.4|         670.051375|
|     674687.2|        674.6871875|
|     700503.3|        700.5033125|
|     733180.0|             733.18|
|     746807.0|            746.807|
|     800000.0|              800.0|
|     800001.2|        800.0011875|
|     800003.6|         800.003625|
|     800005.0|            800.005|
|     833180.0|             833.18|
|     950000.0|              950.0|
|    1000000.0|             1000.0|
|    1000030.8|       1000.0308125|
|    1000510.0|            1000.51|
|    1000511.3|       1000.5113125|
|    1200506.2|         1200.50625|
|    1200507.0|           1200.507|
|    1230083.2|         1230.08325|
|    1231800.0|             1231.8|
|    1300506.2|         1300.50625|
|    1331800.0|             1331.8|
|    1332840.0|            1332.84|
|    1400513.2|         1400.51325|
|    1415002.6|        1415.002625|
|    1420050.2|         1420.05025|
|    1466710.0|            1466.71|
|    1503180.0|            1503.18|
|    1533180.0|            1533.18|
|    1600000.0|             1600.0|
|    1700502.0|           1700.502|
|    1800504.2|         1800.50425|
|    2005023.0|           2005.023|
|    2100507.2|         2100.50725|
|    2150400.0|             2150.4|
|    2300000.0|             2300.0|
|    2600509.2|         2600.50925|
|    2840000.0|             2840.0|
|    3005013.2|         3005.01325|
|    3008331.8|         3008.33175|
|    3100300.0|             3100.3|
|    3180000.0|             3180.0|
|    3180000.2|         3180.00025|
|    3284000.0|             3284.0|
|    3300506.2|         3300.50625|
|    3318000.0|             3318.0|
|    3331800.0|             3331.8|
|    3666747.0|           3666.747|
|    3674720.0|            3674.72|
|    4000010.5|          4000.0105|
|    4000500.0|             4000.5|
|    4200180.0|            4200.18|
|    4203746.5|          4203.7465|
|    4500000.0|             4500.0|
|    4700507.0|           4700.507|
|    5000000.0|             5000.0|
|    5000511.0|           5000.511|
|    5005013.0|           5005.013|
|    5005073.0|           5005.073|
|    5023318.0|           5023.318|
|    5031800.0|             5031.8|
|    5033318.0|           5033.318|
|    5043318.0|           5043.318|
|    5063318.0|           5063.318|
|    5073284.0|           5073.284|
|    5093318.0|           5093.318|
|    5123318.0|           5123.318|
|    5133318.0|           5133.318|
|    5143318.0|           5143.318|
|    5331800.0|             5331.8|
|    5500511.0|           5500.511|
|    6000000.0|             6000.0|
|    6005123.0|           6005.123|
|    6208420.5|          6208.4205|
|    6231800.0|             6231.8|
|    6331800.0|             6331.8|
|    6380051.0|           6380.051|
|    6674681.0|           6674.681|
|    6746133.0|           6746.133|
|    6746833.0|           6746.833|
|    6746929.0|           6746.929|
|    6747240.0|            6747.24|
|    6752050.0|            6752.05|
|    6752505.5|          6752.5055|
|    6800000.5|          6800.0005|
|    6800006.0|           6800.006|
|    6800040.0|            6800.04|
|    6805033.0|           6805.033|
|    6805400.0|             6805.4|
|    6823007.0|           6823.007|
|    6900507.5|          6900.5075|
|    7000511.0|           7000.511|
|    7250033.0|           7250.033|
|    7436805.0|           7436.805|
|    7473013.0|           7473.013|
|    7520502.5|          7520.5025|
|    8000000.5|          8000.0005|
|    8000002.0|           8000.002|
|    8000003.5|          8000.0035|
|    8000004.0|           8000.004|
|    8000005.0|           8000.005|
|    8000007.0|           8000.007|
|    8000011.0|           8000.011|
|    8000012.5|          8000.0125|
|    8000014.5|          8000.0145|
|    8000052.0|           8000.052|
|    8000079.0|           8000.079|
|    8000600.5|          8000.6005|
|    8004700.5|          8004.7005|
|    8005053.0|           8005.053|
|    8006300.5|          8006.3005|
|    8050633.0|           8050.633|
|    8140050.0|            8140.05|
|    8331800.0|             8331.8|
|    8400001.0|           8400.001|
|    8504332.0|           8504.332|
|    8800004.0|           8800.004|
|    8810002.0|           8810.002|
|    9005023.0|           9005.023|
|       1.18E7|            11800.0|
|  1.1800001E7|          11800.001|
|  1.1800005E7|          11800.005|
|  1.1800318E7|          11800.318|
|        1.2E7|            12000.0|
|  1.2000002E7|          12000.002|
|  1.2000004E7|          12000.004|
|  1.2000018E7|          12000.018|
|  1.2000104E7|          12000.104|
|  1.2310051E7|          12310.051|
|    1.27468E7|            12746.8|
|  1.3005023E7|          13005.023|
|  1.3005043E7|          13005.043|
|   1.348017E7|           13480.17|
|  1.4005103E7|          14005.103|
|  1.4505332E7|          14505.332|
|   1.468001E7|           14680.01|
|  1.4680016E7|          14680.016|
|  1.4680043E7|          14680.043|
|  1.5038005E7|          15038.005|
|    1.53318E7|            15331.8|
+-------------+-------------------+

================================================================================================================================================================================================================================================

(tripWorker.df
 .select((col(trip_time_in_secs) / 60).cast("int").alias("trip_time_in_min"))
 .filter(col('trip_time_in_min') > 10)
 .distinct()
 .orderBy('trip_time_in_min')
 .show(10000))
+----------------+
|trip_time_in_min|
+----------------+
|              11|
|              12|
|              13|
|              14|
|              15|
|              16|
|              17|
|              18|
|              19|
|              20|
|              21|
|              22|
|              23|
|              24|
|              25|
|              26|
|              27|
|              28|
|              29|
|              30|
|              31|
|              32|
|              33|
|              34|
|              35|
|              36|
|              37|
|              38|
|              39|
|              40|
|              41|
|              42|
|              43|
|              44|
|              45|
|              46|
|              47|
|              48|
|              49|
|              50|
|              51|
|              52|
|              53|
|              54|
|              55|
|              56|
|              57|
|              58|
|              59|
|              60|
|              61|
|              62|
|              63|
|              64|
|              65|
|              66|
|              67|
|              68|
|              69|
|              70|
|              71|
|              72|
|              73|
|              74|
|              75|
|              76|
|              77|
|              78|
|              79|
|              80|
|              81|
|              82|
|              83|
|              84|
|              85|
|              86|
|              87|
|              88|
|              89|
|              90|
|              91|
|              92|
|              93|
|              94|
|              95|
|              96|
|              97|
|              98|
|              99|
|             100|
|             101|
|             102|
|             103|
|             104|
|             105|
|             106|
|             107|
|             108|
|             109|
|             110|
|             111|
|             112|
|             113|
|             114|
|             115|
|             116|
|             117|
|             118|
|             119|
|             120|
|             121|
|             122|
|             123|
|             124|
|             125|
|             126|
|             127|
|             128|
|             129|
|             130|
|             131|
|             132|
|             133|
|             134|
|             135|
|             136|
|             137|
|             138|
|             139|
|             140|
|             141|
|             142|
|             143|
|             144|
|             145|
|             146|
|             147|
|             148|
|             149|
|             150|
|             151|
|             152|
|             153|
|             154|
|             155|
|             156|
|             157|
|             158|
|             159|
|             160|
|             161|
|             162|
|             163|
|             164|
|             165|
|             166|
|             167|
|             168|
|             169|
|             170|
|             171|
|             172|
|             173|
|             174|
|             175|
|             176|
|             177|
|             178|
|             179|
|             180|
|             181|
|             182|
|             183|
|             184|
|             185|
|             186|
|             187|
|             188|
|             189|
|             191|
|             192|
|             193|
|             194|
|             195|
|             196|
|             197|
|             198|
|             200|
|             201|
|             202|
|             203|
|             204|
|             207|
|             209|
|             211|
|             213|
|             214|
|             216|
|             218|
|             221|
|             222|
|             223|
|             225|
|             229|
|             230|
|             234|
|             237|
|             238|
|             241|
|             243|
|             244|
|             245|
|             248|
|             251|
|             254|
|             261|
|             264|
|             265|
|             266|
|             267|
|             273|
|             275|
|             276|
|             283|
|             284|
|             286|
|             289|
|             297|
|             301|
|             312|
|             316|
|             318|
|             330|
|             332|
|             337|
|             338|
|             349|
|             359|
|             363|
|             365|
|             368|
|             377|
|             379|
|             410|
|             417|
|             433|
|             457|
|             466|
|             471|
|             480|
|             482|
|             484|
|             485|
|             526|
|             550|
|             558|
|             642|
|             718|
|             822|
|             825|
|             831|
|             845|
|             877|
|             884|
|             964|
|            1007|
|            1062|
|            1074|
|            1086|
|            1116|
|            1125|
|            1166|
|            1193|
|            1206|
|            1231|
|            1254|
|            1279|
|            1310|
|            1319|
|            1353|
|            1397|
|            1418|
|            1433|
|            1439|
|           67933|
|           68318|
|           68353|
|           68784|
|           68868|
|           68969|
|           69122|
|           69143|
|           69174|
|           69234|
|           69258|
|           69300|
|           69380|
|           69483|
|           69502|
|           69624|
|           69790|
|           69870|
|           69894|
|           69901|
|           69957|
|           70095|
|           70130|
|           70235|
|           70284|
|           70336|
|           70359|
|           70397|
|           70402|
|           70457|
|           70479|
|           70483|
|           70514|
|           70532|
|           70543|
|           70555|
|           70564|
|           70589|
|           70617|
|           70635|
|           70637|
|           70673|
|           70674|
|           70677|
|           70685|
|           70701|
|           70705|
|           70708|
|           70725|
|           70758|
|           70773|
|           70776|
|           70803|
|           70814|
|           70824|
|           70863|
|           70868|
|           70870|
|           70875|
|           70880|
|           70885|
|           70892|
|           70898|
|           70906|
|           70908|
|           70912|
|           70916|
|           70920|
|           70924|
|           70925|
|           70933|
|           70944|
|           70949|
|           70960|
|           70961|
|           70964|
|           70970|
|           70971|
|           70972|
|           70981|
|           70985|
|           70986|
|           70987|
|           70988|
|           70989|
|           70991|
|           70998|
|           71002|
|           71004|
|           71009|
|           71010|
|           71018|
|           71024|
|           71025|
|           71026|
|           71038|
|           71047|
|           71050|
|           71055|
|           71056|
|           71060|
|           71065|
|           71068|
|           71073|
|           71085|
|           71086|
|           71087|
|           71091|
|           71095|
|           71097|
|           71101|
|           71105|
|           71106|
|           71107|
|           71108|
|           71109|
|           71110|
|           71111|
|           71112|
|           71113|
|           71119|
|           71121|
|           71122|
|           71124|
|           71125|
|           71127|
|           71128|
|           71129|
|           71137|
|           71139|
|           71143|
|           71144|
|           71148|
|           71149|
|           71150|
|           71152|
|           71153|
|           71157|
|           71160|
|           71161|
|           71162|
|           71163|
|           71164|
|           71167|
|           71168|
|           71169|
|           71170|
|           71174|
|           71176|
|           71179|
|           71182|
|           71184|
|           71185|
|           71192|
|           71196|
|           71198|
|           71199|
|           71202|
|           71204|
|           71209|
|           71210|
|           71213|
|           71214|
|           71215|
|           71217|
|           71221|
|           71223|
|           71225|
|           71226|
|           71228|
|           71232|
|           71233|
|           71234|
|           71235|
|           71236|
|           71237|
|           71238|
|           71239|
|           71240|
|           71242|
|           71243|
|           71244|
|           71245|
|           71246|
|           71247|
|           71250|
|           71251|
|           71252|
|           71256|
|           71257|
|           71260|
|           71261|
|           71262|
|           71263|
|           71264|
|           71265|
|           71266|
|           71267|
|           71269|
|           71270|
|           71271|
|           71272|
|           71273|
|           71275|
|           71276|
|           71278|
|           71280|
|           71281|
|           71282|
|           71283|
|           71284|
|           71285|
|           71290|
|           71291|
|           71292|
|           71293|
|           71294|
|           71295|
|           71296|
|           71298|
|           71300|
|           71301|
|           71302|
|           71303|
|           71304|
|           71305|
|           71306|
|           71307|
|           71308|
|           71309|
|           71310|
|           71312|
|           71313|
|           71314|
|           71316|
|           71317|
|           71318|
|           71321|
|           71322|
|           71323|
|           71324|
|           71325|
|           71327|
|           71328|
|           71329|
|           71331|
|           71332|
|           71333|
|           71334|
|           71335|
|           71336|
|           71338|
|           71339|
|           71340|
|           71341|
|           71342|
|           71343|
|           71344|
|           71345|
|           71346|
|           71348|
|           71349|
|           71350|
|           71351|
|           71352|
|           71353|
|           71354|
|           71355|
|           71356|
|           71357|
|           71358|
|           71359|
|           71360|
|           71361|
|           71362|
|           71363|
|           71364|
|           71365|
|           71366|
|           71367|
|           71368|
|           71369|
|           71370|
|           71371|
|           71372|
|           71373|
|           71374|
|           71375|
|           71376|
|           71377|
|           71378|
|           71379|
|           71380|
|           71381|
|           71382|
|           71383|
|           71384|
|           71385|
|           71386|
|           71387|
|           71388|
|           71389|
|           71390|
|           71391|
|           71393|
|           71394|
|           71395|
|           71396|
|           71397|
|           71398|
|           71400|
|           71401|
|           71402|
|           71404|
|           71405|
|           71406|
|           71407|
|           71408|
|           71409|
|           71410|
|           71411|
|           71412|
|           71413|
|           71414|
|           71415|
|           71416|
|           71417|
|           71418|
|           71419|
|           71420|
|           71421|
|           71422|
|           71423|
|           71424|
|           71425|
|           71426|
|           71427|
|           71428|
|           71429|
|           71430|
|           71431|
|           71432|
|           71433|
|           71434|
|           71435|
|           71436|
|           71437|
|           71438|
|           71439|
|           71440|
|           71441|
|           71442|
|           71444|
|           71445|
|           71446|
|           71447|
|           71448|
|           71449|
|           71450|
|           71451|
|           71452|
|           71453|
|           71454|
|           71455|
|           71456|
|           71457|
|           71458|
|           71459|
|           71460|
|           71461|
|           71462|
|           71463|
|           71464|
|           71465|
|           71466|
|           71467|
|           71468|
|           71469|
|           71470|
|           71471|
|           71472|
|           71473|
|           71474|
|           71475|
|           71476|
|           71477|
|           71478|
|           71479|
|           71480|
|           71481|
|           71482|
|           71483|
|           71484|
|           71485|
|           71486|
|           71487|
|           71488|
|           71489|
|           71490|
|           71491|
|           71492|
|           71493|
|           71494|
|           71495|
|           71496|
|           71497|
|           71498|
|           71499|
|           71500|
|           71501|
|           71502|
|           71503|
|           71504|
|           71505|
|           71506|
|           71507|
|           71508|
|           71509|
|           71510|
|           71511|
|           71512|
|           71513|
|           71514|
|           71515|
|           71516|
|           71517|
|           71518|
|           71519|
|           71520|
|           71521|
|           71522|
|           71523|
|           71524|
|           71525|
|           71526|
|           71527|
|           71528|
|           71529|
|           71530|
|           71531|
|           71532|
|           71533|
|           71534|
|           71535|
|           71536|
|           71537|
|           71538|
|           71539|
|           71540|
|           71541|
|           71542|
|           71543|
|           71544|
|           71545|
|           71546|
|           71547|
|           71548|
|           71549|
|           71550|
|           71551|
|           71552|
|           71553|
|           71554|
|           71555|
|           71556|
|           71557|
|           71558|
|           71559|
|           71560|
|           71561|
|           71562|
|           71563|
|           71564|
|           71565|
|           71566|
|           71567|
|           71568|
|           71569|
|           71570|
|           71571|
|           71572|
|           71573|
|           71574|
|           71575|
|           71576|
|           71577|
|           71578|
|           71579|
|           71580|
|           71581|
|           71582|
+----------------+

================================================================================================================================================================================================================================================

preprocess_filter_condition = ((col(passenger_count) > 0) & (col(passenger_count) <= 9)
                                & (col(trip_distance) > 0) & (col(trip_distance) < 70_000)
                                & (col(trip_time_in_secs) > 0) & (col(trip_time_in_secs) < 60_000))

================================================================================================================================================================================================================================================

#After preprocess
num_cols = [f.name for f in tripWorker.df.schema.fields if isinstance(f.dataType, t.NumericType)]
tripWorker.df.describe(num_cols).show()
+-------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+
|summary|         rate_code|   passenger_count|trip_time_in_secs|     trip_distance|  pickup_longitude|   pickup_latitude| dropoff_longitude| dropoff_latitude|
+-------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+
|  count|         171899205|         171899205|        171899205|         171899205|         171899205|         171899205|         171899205|        171899205|
|   mean|1.0270787523421065|1.7116061647870913|757.7813952775407|2.9229047508589625|-72.55375877214989|39.808676497132545|-72.55916906300426|39.81256532636291|
| stddev|0.3005756867875085|1.3771786361954093|560.5441541100786| 20.95747950872376|10.967169280209191| 8.655816513663162|10.938848778547408|8.685174083633768|
|    min|                 0|                 1|                1|              0.01|         -3084.296|        -3547.9207|        -3116.2698|       -3547.9207|
|    max|               221|                 9|            52620|           63318.0|         2945.9587|         3310.3645|          2386.995|         3577.132|
+-------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+
