fareWorker.df.show()
+--------------------+--------------------+---------+-------------------+------------+-----------+---------+-------+----------+------------+------------+
|           medallion|        hack_license|vendor_id|    pickup_datetime|payment_type|fare_amount|surcharge|mta_tax|tip_amount|tolls_amount|total_amount|
+--------------------+--------------------+---------+-------------------+------------+-----------+---------+-------+----------+------------+------------+
|89D227B655E5C82AE...|BA96DE419E711691B...|      CMT|2013-01-01 15:11:48|         CSH|        6.5|      0.0|    0.5|       0.0|         0.0|         7.0|
|0BD7C8F5BA12B88E0...|9FD8F69F0804BDB55...|      CMT|2013-01-06 00:18:35|         CSH|        6.0|      0.5|    0.5|       0.0|         0.0|         7.0|
|0BD7C8F5BA12B88E0...|9FD8F69F0804BDB55...|      CMT|2013-01-05 18:49:41|         CSH|        5.5|      1.0|    0.5|       0.0|         0.0|         7.0|
|DFD2202EE08F7A8DC...|51EE87E3205C985EF...|      CMT|2013-01-07 23:54:15|         CSH|        5.0|      0.5|    0.5|       0.0|         0.0|         6.0|
|DFD2202EE08F7A8DC...|51EE87E3205C985EF...|      CMT|2013-01-07 23:25:03|         CSH|        9.5|      0.5|    0.5|       0.0|         0.0|        10.5|
|20D9ECB2CA0767CF7...|598CCE5B9C1918568...|      CMT|2013-01-07 15:27:48|         CSH|        9.5|      0.0|    0.5|       0.0|         0.0|        10.0|
|496644932DF393260...|513189AD756FF14FE...|      CMT|2013-01-08 11:01:15|         CSH|        6.0|      0.0|    0.5|       0.0|         0.0|         6.5|
|0B57B9633A2FECD3D...|CCD4367B417ED6634...|      CMT|2013-01-07 12:39:18|         CSH|       34.0|      0.0|    0.5|       0.0|         4.8|        39.3|
|2C0E91FF20A856C89...|1DA2F6543A62B8ED9...|      CMT|2013-01-07 18:15:47|         CSH|        5.5|      1.0|    0.5|       0.0|         0.0|         7.0|
|2D4B95E2FA7B2E851...|CD2F522EEE1FF5F5A...|      CMT|2013-01-07 15:33:28|         CSH|       13.0|      0.0|    0.5|       0.0|         0.0|        13.5|
|E12F6AF991172EAC3...|06918214E951FA000...|      CMT|2013-01-08 13:11:52|         CSH|        7.5|      0.0|    0.5|       0.0|         0.0|         8.0|
|E12F6AF991172EAC3...|06918214E951FA000...|      CMT|2013-01-08 09:50:05|         CSH|        9.0|      0.0|    0.5|       0.0|         0.0|         9.5|
|78FFD9CD0CDA541F3...|E949C583ECF62C8F0...|      CMT|2013-01-10 12:07:08|         CSH|        9.5|      0.0|    0.5|       0.0|         0.0|        10.0|
|237F49C3ECC11F502...|93C363DDF8ED9385D...|      CMT|2013-01-07 07:35:47|         CSH|       10.0|      0.0|    0.5|       0.0|         0.0|        10.5|
|3349F919AA8AE5DC9...|7CE849FEF67514F08...|      CMT|2013-01-10 15:42:29|         CSH|       15.5|      0.0|    0.5|       0.0|         0.0|        16.0|
|3349F919AA8AE5DC9...|7CE849FEF67514F08...|      CMT|2013-01-10 14:27:28|         CSH|       16.5|      0.0|    0.5|       0.0|         0.0|        17.0|
|4C005EEBAA7BF26B8...|351BE7D984BE17DB2...|      CMT|2013-01-07 22:09:59|         CSH|        9.0|      0.5|    0.5|       0.0|         0.0|        10.0|
|7D99C30FCE69B1A9D...|460C3F57DD9CB2265...|      CMT|2013-01-07 17:18:16|         CSH|        4.5|      1.0|    0.5|       0.0|         0.0|         6.0|
|E6FBF80668FE0611A...|36773E80775F26CD1...|      CMT|2013-01-07 06:08:51|         CSH|        7.0|      0.0|    0.5|       0.0|         0.0|         7.5|
|0C5296F3C8B16E702...|D2363240A9295EF57...|      CMT|2013-01-07 22:25:46|         CSH|       10.5|      0.5|    0.5|       0.0|         0.0|        11.5|
+--------------------+--------------------+---------+-------------------+------------+-----------+---------+-------+----------+------------+------------+

================================================================================================================================================================================================================================================

num_cols = [f.name for f in fareWorker.df.schema.fields if isinstance(f.dataType, t.NumericType)]
fareWorker.df.describe(num_cols).show()
+-------+------------------+-------------------+-------------------+------------------+------------------+------------------+
|summary|       fare_amount|          surcharge|            mta_tax|        tip_amount|      tolls_amount|      total_amount|
+-------+------------------+-------------------+-------------------+------------------+------------------+------------------+
|  count|         173179759|          173179759|          173179759|         173179759|         173179759|         173179759|
|   mean|12.350179522927595|0.31934740878057855| 0.4982070178884221|1.3651019000996143|0.2500290074862975|14.790096624647008|
| stddev|17.617817347856057| 0.4093621795321131|0.03477811964712744| 2.193723798436221|1.2135947987960785|  69.0272489255159|
|    min|           -1430.0|              -19.5|               -0.5|            -96.82|            -22.25|           -1430.0|
|    max|         158995.81|              854.5|              80.05|            888.19|            960.09|          685908.1|
+-------+------------------+-------------------+-------------------+------------------+------------------+------------------+

================================================================================================================================================================================================================================================

preprocess_filter_condition = (
        (col(fare_amount) > 0)
        & (col(surcharge) > 0)
        & (col(mta_tax) > 0)
        & (col(tip_amount) > 0)
        & (col(tolls_amount) > 0)
        & (col(total_amount) > 0)
    )

================================================================================================================================================================================================================================================

#After preprocessing
num_cols = [f.name for f in fareWorker.df.schema.fields if isinstance(f.dataType, t.NumericType)]
fareWorker.df.describe(num_cols).show()
+-------+------------------+------------------+-------+------------------+-----------------+------------------+
|summary|       fare_amount|         surcharge|mta_tax|        tip_amount|     tolls_amount|      total_amount|
+-------+------------------+------------------+-------+------------------+-----------------+------------------+
|  count|           1450887|           1450887|1450887|           1450887|          1450887|           1450887|
|   mean|29.863166580163966|0.6842392894832685|    0.5| 6.770913894891303|5.291119777738701|43.109572573213896|
| stddev| 9.264048374108768|0.2422062176420006|    0.0|3.1444275597553943|1.036669278240577|11.643178495675743|
|    min|              2.42|              0.02|    0.5|              0.01|             0.01|              3.86|
|    max|             342.5|              10.5|    0.5|             818.8|            110.0|            855.63|
+-------+------------------+------------------+-------+------------------+-----------------+------------------+
